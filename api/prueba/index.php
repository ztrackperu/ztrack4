<?php
header('Content-type: application/json; charset=utf-8');
date_default_timezone_set('America/Lima');
// necesarios del modelo 
require_once '../../models/api.php';
$api = new ApiModel();
$datosRecibidos = file_get_contents("php://input");
//$datosRecibidos ='{"tipo": "Madurador", "nombre_contenedor": "COMANDO_MADURADOR", "set_point": 28.0, "temp_supply_1": 5.0, "temp_supply_2": 0.0, "return_air": 0.0, "evaporation_coil": 0.0, "condensation_coil": 0.0, "compress_coil_1": 0.0, "compress_coil_2": 0.0, "ambient_air": 0.0, "cargo_1_temp": 0.0, "cargo_2_temp": 0.0, "cargo_3_temp": 0.0, "cargo_4_temp": 0.0, "relative_humidity": 50.0, "avl": 0.0, "suction_pressure": 0.0,"discharge_pressure": 0.0, "line_voltage": 0.0, "line_frequency": 0.0, "consumption_ph_1": 0.0, "consumption_ph_2": 0.0, "consumption_ph_3": 0.0, "co2_reading": 0.0, "o2_reading": 20.7, "evaporator_speed": 0.0, "condenser_speed": 0.0, "battery_voltage": 0.0, "power_kwh": 0.0, "power_trip_reading": 0.0, "power_trip_duration": 0.0, "suction_temp": 0.0, "discharge_temp": 0.0, "supply_air_temp": 0.0, "return_air_temp": 0.0, "dl_battery_temp": 0.0, "dl_battery_charge": 0.0, "power_consumption": 0.0, "power_consumption_avg": 0.0, "alarm_present": 0.0, "capacity_load": 0.0, "power_state": 0.0, "controlling_mode": "NA", "humidity_control": 0.0, "humidity_set_point": 1011010.0, "fresh_air_ex_mode": 0.0, "fresh_air_ex_rate": 0.0, "fresh_air_ex_delay": 0.0, "set_point_o2": 20.7, "set_point_co2": 3.0, "defrost_term_temp": 0.0, "defrost_interval": 0.0, "water_cooled_conde": 0.0, "usda_trip": 0.0, "evaporator_exp_valve": 0.0, "suction_mod_valve": 0.0, "hot_gas_valve": 0.0, "economizer_valve": 0.0, "ethylene": 0.0, "stateProcess": "RESET", "stateInyection": "NO INJECTING", "timerOfProcess": 0, "modelo": "THERMOKING2", "latitud": 0.0, "longitud": 0.0,"defrost_prueba":3,"ripener_prueba":3}';
//$datosRecibidos ='{"1B": "1B02", "tipo": "Madurador", "nombre_contenedor": "ZGRU4701435", "set_point": 19.0, "temp_supply_1": 21.3, "temp_supply_2": -3277.0, "return_air": 20.3, "evaporation_coil": 20.2, "condensation_coil": 43.6, "compress_coil_1": 57.2, "compress_coil_2": -3276.9, "ambient_air": 26.2, "cargo_1_temp": 0.0, "cargo_2_temp": 0.0, "cargo_3_temp": 0.0, "cargo_4_temp": 0.0, "relative_humidity": 82.0, "avl": 0.0, "suction_pressure": 3276.6, "discharge_pressure": 3276.6, "line_voltage": 463.0, "line_frequency": 60.0, "consumption_ph_1": 6.2, "consumption_ph_2": 7.7, "consumption_ph_3": 7.6, "co2_reading": 25.3, "o2_reading": 3276.6, "evaporator_speed": 30.0, "condenser_speed": 28.0, "battery_voltage": 4563.3, "power_kwh": 160.6, "power_trip_reading": 3276.6, "power_trip_duration": 3276.6, "suction_temp": 21.3, "discharge_temp": 20.3, "supply_air_temp": 0.24, "return_air_temp": 0.0, "dl_battery_temp": 1.95, "dl_battery_charge": 5.3, "power_consumption": 5.28, "power_consumption_avg": 32.0, "alarm_present": 32.0, "capacity_load": 32.0, "power_state": 32.0, "controlling_mode": 32.0, "humidity_control": 32.0, "humidity_set_point": 32766.0, "fresh_air_ex_mode": 3276.6, "fresh_air_ex_rate": 3276.6, "fresh_air_ex_delay": 3276.6, "set_point_o2": 18.0, "set_point_co2": 6.0, "defrost_term_temp": 6.0, "defrost_interval": 6.0, "water_cooled_conde": 255.0, "usda_trip": 255.0, "evaporator_exp_valve": 255.0, "suction_mod_valve": 255.0, "hot_gas_valve": 7.3, "economizer_valve": 7.28, "ethylene": 7.28, "stateProcess": 7.28, "stateInyection": 0.0, "timerOfProcess": 0.0, "modelo": "THERMOKING", "latitud": 0.0, "longitud": 0.0, "defrost_prueba": 2, "ripener_prueba": 2}';
//$datosRecibidos ='{"1B": "1B02", "tipo": "Madurador", "nombre_contenedor": "COMANDO_MADURADOR", "set_point": 19, "temp_supply_1": 17.5, "temp_supply_2": -3277.0, "return_air": 17.9, "evaporation_coil": 18.2, "condensation_coil": 40.3, "compress_coil_1": 59.4, "compress_coil_2": -3276.9, "ambient_air": 25.3, "cargo_1_temp": 0.0, "cargo_2_temp": 0.0, "cargo_3_temp": 0.0, "cargo_4_temp": 0.0, "relative_humidity": 74.0, "avl": 0.0, "suction_pressure": 3264.06, "discharge_pressure": 0.0, "line_voltage": 459.0, "line_frequency": 60.0, "consumption_ph_1": 9.0, "consumption_ph_2": 15.3, "consumption_ph_3": 15.5, "co2_reading": 25.3, "o2_reading": 3276.6, "evaporator_speed": 60.0, "condenser_speed": 30.0, "battery_voltage": 4553.9, "power_kwh": 151.3, "power_trip_reading": 3264.06, "power_trip_duration": 0.0, "suction_temp": 0.0, "discharge_temp": 17.9, "supply_air_temp": 0.24, "return_air_temp": 0.0, "dl_battery_temp": 9.8, "dl_battery_charge": 5.2, "power_consumption": 5.19, "power_consumption_avg": 30.0, "alarm_present": 30.0, "capacity_load": 30.0, "power_state": 30.0, "controlling_mode": 30.0, "humidity_control": 30.0, "humidity_set_point": 32766.0, "fresh_air_ex_mode": 3276.6, "fresh_air_ex_rate": 3276.6, "fresh_air_ex_delay": 0.0, "set_point_o2": 18.0, "set_point_co2": 6.0, "defrost_term_temp": 6.0, "defrost_interval": 6.0, "water_cooled_conde": 255.0, "usda_trip": 255.0, "evaporator_exp_valve": 255.0, "suction_mod_valve": 255.0, "hot_gas_valve": 6.3, "economizer_valve": 6.28, "ethylene": 6.28, "stateProcess": 6.28, "stateInyection": 0.0, "timerOfProcess": 0.0, "modelo": "THERMOKING", "latitud": 0.0, "longitud": 0.0, "defrost_prueba": 2, "ripener_prueba": 2}';
$contenedor = json_decode($datosRecibidos);
$primerFiltro = $contenedor->ID ;
if($primerFiltro=="3B01"){
   $mensaje ="OK";
}else{
    $mensaje = "PROBLEMAS CON LA TRAMA";

}
echo $mensaje;  
 
?>
